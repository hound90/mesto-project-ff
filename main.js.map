{"version":3,"file":"main.js","mappings":"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","sources":["webpack://yandex_praktikum/./src/components/card.js","webpack://yandex_praktikum/./src/components/modal.js","webpack://yandex_praktikum/./src/components/validate.js","webpack://yandex_praktikum/./src/components/api.js","webpack://yandex_praktikum/./src/scripts/index.js"],"sourcesContent":["\r\nexport function createCard (cardObject, userID, { cardRemove, openImage, cardLike }) {\r\n  const cardElement = document.querySelector('#card-template').content.querySelector('.card').cloneNode(true);\r\n  const buttonDelete = cardElement .querySelector('.card__delete-button');\r\n  const cardImage = cardElement.querySelector('.card__image');\r\n  const likeButton = cardElement.querySelector('.card__like-button');\r\n  const likeCountElement = cardElement.querySelector('.card_like_counter');\r\n\r\n  cardElement.querySelector('.card__title').textContent = cardObject.name;\r\n  cardImage.src = cardObject.link;\r\n  cardImage.alt = cardObject.name;\r\n   // ------------------------------------------------------------------------\r\n  const isLiked = cardObject.likes.some((user) => user._id === userID);\r\n  if (isLiked) {likeButton.classList.add('card__like-button_is-active')}\r\n  likeCountElement.textContent = cardObject.likes.length;\r\n\r\n  likeButton.addEventListener('click', () => {cardLike(cardObject._id, likeButton, likeCountElement)});\r\n  // ------------------------------------------------------------------------\r\n  cardImage.addEventListener('click', () => {openImage(cardObject)});\r\n  // ------------------------------------------------------------------------\r\n  if (cardObject.owner._id === userID) {\r\n  buttonDelete.addEventListener('click', () => {cardRemove(cardObject._id, cardElement)})\r\n  } else {buttonDelete.remove()}\r\n  // ------------------------------------------------------------------------\r\n  return cardElement;\r\n}\r\n\r\n\r\n\r\n","const handleEsc = (evt) => {\r\n  if (evt.key === 'Escape') {\r\n    const popup = document.querySelector('.popup_is-opened');\r\n    closeModal(popup);\r\n  }\r\n};\r\n\r\nexport const openModal = (modal) => {\r\n  document.addEventListener('keydown', handleEsc);\r\n  modal.classList.add('popup_is-animated');\r\n  setTimeout(() => {\r\n   modal.classList.add('popup_is-opened');\r\n}, 100);\r\n};\r\n\r\nexport const closeModal = (modal) => {\r\n  modal.classList.remove('popup_is-opened');\r\n  setTimeout(() => {\r\n   modal.classList.remove('popup_is-animated');\r\n}, 500);\r\n  document.removeEventListener('keydown', handleEsc);\r\n};\r\n\r\nexport const addPopupListener = (modal) => {\r\n const closeButton = modal.querySelector('.popup__close');\r\n  closeButton.addEventListener('click', () => {\r\n    closeModal(modal);\r\n  });\r\n\r\n  modal.addEventListener('mousedown', (evt) => {\r\n    if (evt.target === evt.currentTarget)\r\n      closeModal(modal);\r\n  });\r\n}\r\n","\r\n// Функция, которая добавляет класс с ошибкой\r\nconst showInputError = (formElement, inputElement, errorMessage, selectors) => {\r\n  const errorElement = formElement.querySelector(`.${inputElement.id}-error`);\r\n  inputElement.classList.add(selectors.inputErrorClass);\r\n  errorElement.textContent = errorMessage;\r\n  errorElement.classList.add(selectors.errorClass);\r\n};\r\n\r\n// Функция, которая удаляет класс с ошибкой\r\nconst hideInputError = (formElement, inputElement, selectors) => {\r\n  const errorElement = formElement.querySelector(`.${inputElement.id}-error`);\r\n  inputElement.classList.remove(selectors.inputErrorClass);\r\n  errorElement.classList.remove(selectors.errorClass);\r\n  errorElement.textContent = '';\r\n};\r\n\r\nexport const clearValidation = (formElement, selectors) => {\r\n  const inputList = Array.from(formElement.querySelectorAll(selectors.inputSelector));\r\n  const buttonElement = formElement.querySelector(selectors.submitButtonSelector);\r\n  \r\n  inputList.forEach ((inputElement) => {\r\n    hideInputError(formElement, inputElement, selectors);\r\n    \r\n    });\r\n  toggleButtonState (inputList, buttonElement, selectors);\r\n}\r\n\r\nconst checkInputValidity = (formElement, inputElement, selectors) => {\r\n  if (inputElement.validity.patternMismatch) {\r\n    inputElement.setCustomValidity(inputElement.dataset.errorMessage);\r\n  } else {\r\n    inputElement.setCustomValidity('');\r\n  }\r\n\r\n  if (!inputElement.validity.valid) {\r\n    showInputError(formElement, inputElement, inputElement.validationMessage, selectors);\r\n\r\n  } else {\r\n    hideInputError(formElement, inputElement, selectors);\r\n  }\r\n};\r\n\r\nfunction setEventListeners (formElement, selectors) {\r\n  const inputList = Array.from(formElement.querySelectorAll(selectors.inputSelector));\r\n  const buttonElement = formElement.querySelector(selectors.submitButtonSelector);\r\n\r\n  toggleButtonState(inputList, buttonElement, selectors);\r\n\r\n  inputList.forEach ((inputElement) => {\r\n    inputElement.addEventListener('input', () => {\r\n      checkInputValidity(formElement, inputElement, selectors);\r\n      toggleButtonState(inputList, buttonElement, selectors);\r\n    });\r\n  });\r\n}\r\n\r\nexport function enableValidation (selectors) {\r\n  const formList = Array.from(document.querySelectorAll(selectors.formSelector));\r\n  formList.forEach((formElement) => {\r\n        setEventListeners(formElement, selectors);\r\n    });\r\n}\r\n\r\nfunction hasInvalidInput (inputList) {\r\n  return inputList.some((inputElement) => {\r\n    return !inputElement.validity.valid;\r\n});\r\n}\r\n\r\nfunction toggleButtonState (inputList, buttonElement, selectors) {\r\n\r\n    if (hasInvalidInput(inputList)) {\r\n    buttonElement.classList.add(selectors.inactiveButtonClass);\r\n    buttonElement.disabled = true;\r\n  } else {\r\n    buttonElement.classList.remove(selectors.inactiveButtonClass);\r\n    buttonElement.disabled = false;\r\n  }\r\n};\r\n\r\n\r\n","const cohortId = 'wff-cohort-42';\r\nconst apiToken = '6ac072b8-907a-4352-86ed-4f38c01485f9';\r\nconst PATH = 'https://nomoreparties.co/v1/'\r\nconst headers = {\r\n      authorization: apiToken,\r\n      \"Content-Type\": \"application/json\"\r\n    }\r\n\r\n//Преобразование и проверка на ошибку\r\nfunction checkResponse(res) {\r\n  if (res.ok) {\r\n    return res.json();\r\n  }\r\n  return res.json()\r\n    .then(\r\n      (error) => {\r\n        error.httpStatusCode = res.status;\r\n        return Promise.reject(error);\r\n      }\r\n    );\r\n}\r\n\r\n//Получаем данные профиля\r\nexport function getUserProfile() {\r\n  return fetch(`${PATH}${cohortId}/users/me`, {\r\n    method: \"GET\",\r\n    headers: headers,\r\n  }).then(checkResponse);\r\n}\r\n\r\n\r\n//Получаем карточки\r\nexport function getCards() {\r\n  return fetch(`${PATH}${cohortId}/cards`, {\r\n    method: \"GET\",\r\n    headers: headers,\r\n  }).then(checkResponse);\r\n}\r\n\r\n//Отправляем запрос на изменения профиля по номеру ID\r\nexport function editProfile(nameUser, aboutUser) {\r\n  return fetch(`${PATH}${cohortId}/users/me`, {\r\n    method: \"PATCH\",\r\n    headers: headers,\r\n    body: JSON.stringify({\r\n    name: nameUser,\r\n    about: aboutUser\r\n  })\r\n\r\n  }).then(checkResponse);\r\n}\r\n\r\n//Добавляем карточку \r\nexport function addCard(nameCard, linkCard) {\r\n  return fetch(`${PATH}${cohortId}/cards`, {\r\n    method: \"POST\",\r\n    headers: headers,\r\n    body: JSON.stringify({\r\n    name: nameCard,\r\n    link: linkCard\r\n  })\r\n\r\n  }).then(checkResponse);\r\n}\r\n\r\n//Поставить/удалить лайк\r\nexport function toggleLike (cardID, isLiked) {\r\n  const endpoint = `${PATH}${cohortId}/cards/likes/${cardID}`;\r\n  const fetchOptions = {\r\n    headers: headers,\r\n    method: isLiked ? 'DELETE' : 'PUT',\r\n  };\r\n  return fetch(endpoint, fetchOptions).then(checkResponse);\r\n}\r\n\r\n//Удаление карточки\r\nexport function deleteCard(cardID) {\r\n  return fetch (`${PATH}${cohortId}/cards/${cardID}`, {\r\n    method: \"DELETE\",\r\n    headers: headers,\r\n  }).then(checkResponse);\r\n}\r\n\r\n//Изменение аватарки\r\nexport function updateAvatar(updateAvatarLink) {\r\n  return fetch(`${PATH}${cohortId}/users/me/avatar`, {\r\n    method: \"PATCH\",\r\n    headers: headers,\r\n    body: JSON.stringify({ avatar: updateAvatarLink }),\r\n  }).then(checkResponse);\r\n}","import '../pages/index.css';\r\nimport { createCard } from '../components/card.js';\r\nimport { openModal, closeModal, addPopupListener } from '../components/modal.js';\r\nimport { enableValidation, clearValidation } from '../components/validate.js';\r\nimport { getUserProfile, getCards, editProfile, addCard, toggleLike, deleteCard, updateAvatar } from '../components/api.js';\r\n\r\nconst cardList = document.querySelector('.places__list');\r\n\r\n// Кнопка и попап редактирования профиля\r\nconst editProfileButton = document.querySelector('.profile__edit-button');\r\nconst popupEdit = document.querySelector('.popup_type_edit');\r\nconst profileTitle = document.querySelector('.profile__title');\r\nconst profileDescription = document.querySelector('.profile__description'); \r\nconst profileImage = document.querySelector('.profile__image');\r\nconst editProfileSubmit = popupEdit .querySelector('.popup__button');\r\n\r\n// Форма попапа редактирования профиля\r\n\r\nconst formElement = document.forms['edit-profile'];\r\nconst nameInput = formElement.elements.name;\r\nconst jobInput = formElement.elements.description;\r\n\r\n// Кнопка добавления и открытие попап изображения\r\nconst addImageButton = document.querySelector('.profile__add-button');\r\nconst popupNewCard = document.querySelector('.popup_type_new-card');\r\nconst popupImage = document.querySelector('.popup_type_image');\r\nconst zoomImage = popupImage.querySelector('.popup__image');\r\nconst captionImage = popupImage.querySelector('.popup__caption');\r\nconst editCardSubmit = popupNewCard.querySelector('.popup__button');\r\n// Форма попапа подтверждения удаления карточки\r\nconst popupConfirmationDelete = document.querySelector('.popup_confirmation_delete')\r\nconst formConfirmation = document.forms.confirmation;\r\nconst buttonDeleteConfirmation = popupConfirmationDelete.querySelector('.popup__button');\r\n\r\n\r\n// Форма попапа добавления карточки\r\nconst formElementCard = document.forms['new-place'];\r\nconst cardNameInput = formElementCard.elements['place-name'];\r\nconst cardLinkInput = formElementCard.elements.link;\r\n\r\n// Форма попапа изменения аватарки\r\nconst avatarPopup = document.querySelector('.popup_avatar_edit');\r\nconst avatarForm = document.forms['edit_avatar'];\r\nconst avatarSubmitButton = avatarForm.querySelector(\".popup__button\");\r\n\r\n\r\nconst validationConfig = {\r\n  formSelector: '.popup__form' ,\r\n  inputSelector: '.popup__input',\r\n  submitButtonSelector: '.popup__button',\r\n  inactiveButtonClass: 'button_disabled',\r\n  inputErrorClass: 'form__input_type_error',\r\n  errorClass: 'form__input-error_active'\r\n}\r\n\r\nlet userId\r\nlet cardForDelete = {}\r\n\r\n\r\n// Открытие попапа профиля\r\neditProfileButton.addEventListener('click', () => {\r\n   nameInput.value = profileTitle.textContent;\r\n   jobInput.value = profileDescription.textContent;\r\n   clearValidation(popupEdit, validationConfig);\r\n   openModal(popupEdit);\r\n});\r\n// Открытие попапа добавления изображений\r\naddImageButton.addEventListener('click', () => {\r\n   clearValidation(popupNewCard, validationConfig);\r\n   formElementCard.reset();\r\n   openModal(popupNewCard);\r\n});\r\n// Открытие попапа карточки\r\nfunction handleOpenImage({ name, link }) {\r\n   zoomImage.src = link;\r\n   zoomImage.alt = name;\r\n   captionImage.textContent = name;\r\n   openModal(popupImage);\r\n}\r\n\r\n// Открытие попапа изменения аватарки\r\nprofileImage.addEventListener(\"click\", () => {\r\n   clearValidation(avatarPopup, validationConfig);\r\n   avatarForm.reset();\r\n   openModal(avatarPopup);\r\n});\r\n\r\n// Включение валидации\r\nenableValidation(validationConfig);\r\n// ------------------------------------------------------------------------\r\n\r\n// Слушатели для всех попапов\r\naddPopupListener(popupEdit);\r\naddPopupListener(popupNewCard);\r\naddPopupListener(popupImage);\r\naddPopupListener(popupConfirmationDelete);\r\naddPopupListener(avatarPopup);\r\n// ------------------------------------------------------------------------\r\n\r\n\r\n// Лоадер\r\nfunction renderLoading(isLoading, buttonElement) {\r\n  if (isLoading) {\r\n    buttonElement.textContent = \"Сохранение...\";\r\n    buttonElement.disabled = true;\r\n  } else {\r\n    buttonElement.textContent = \"Сохранить\";\r\n    buttonElement.disabled = false;\r\n  }\r\n}\r\n// ------------------------------------------------------------------------\r\n\r\n\r\n\r\n// Редактирование профиля\r\nfunction handleFormSubmit(evt) {\r\n   evt.preventDefault();\r\n   \r\n   renderLoading(true, editProfileSubmit)\r\n   editProfile(nameInput.value, jobInput.value).then((res) => {\r\n      profileTitle.textContent = res.name;\r\n      profileDescription.textContent = res.about;\r\n      closeModal(popupEdit);\r\n   })\r\n   .finally(() => {renderLoading(false, editProfileSubmit)})\r\n}\r\n formElement.addEventListener('submit', handleFormSubmit); \r\n\r\n\r\n// Добавление новой карточки\r\nfunction handleAddNewCardSubmit(evt) {\r\n   evt.preventDefault();\r\n   renderLoading(true, editCardSubmit)\r\n   addCard(cardNameInput.value, cardLinkInput.value).then((cardObject) => {\r\n      const cardElement = createCard(cardObject, userId, cardCallbacks)\r\n      cardList.prepend(cardElement);\r\n      formElementCard.reset();\r\n      closeModal(popupNewCard);\r\n   })\r\n   .finally(() => {renderLoading(false, editCardSubmit)})\r\n   \r\n}\r\n formElementCard.addEventListener('submit', handleAddNewCardSubmit);\r\n\r\n// Лайк для карточки\r\nfunction handleLikeSubmit (cardID, likeButton, likeCountElement) {\r\n  const isLiked = likeButton.classList.contains(\"card__like-button_is-active\");\r\n  \r\n  toggleLike(cardID, isLiked)\r\n    .then((updatedCardData) => {\r\n      likeButton.classList.toggle(\"card__like-button_is-active\", !isLiked);\r\n      if (likeCountElement) {\r\n        likeCountElement.textContent = updatedCardData.likes.length;\r\n      }\r\n    })\r\n    .catch((err) => {\r\n      console.error(`Ошибка при изменении лайка: ${err}`);\r\n    });\r\n};\r\n// ------------------------------------------------------------------------\r\n//Удаление карточки через модальное окно\r\n\r\nconst handleDeleteCard = (cardID, cardElement) => {\r\n  cardForDelete = {\r\n    id: cardID,\r\n    cardElement\r\n  }\r\n  \r\n  openModal(popupConfirmationDelete);\r\n};\r\n\r\n//Обработчик удаления\r\nconst handleDeleteCardSubmit = (evt) => {\r\n  evt.preventDefault();\r\n  if (!cardForDelete.cardElement) return;\r\n  \r\n  renderLoading(true, buttonDeleteConfirmation);\r\n  \r\n  deleteCard(cardForDelete.id).then(() => {\r\n      cardForDelete.cardElement.remove();\r\n      closeModal(popupConfirmationDelete);\r\n      cardForDelete = {};\r\n    })\r\n    .catch((err) => {\r\n      console.error(`Ошибка при удалении карточки: ${err}`);\r\n    })\r\n    .finally(() => {\r\n      renderLoading(false, buttonDeleteConfirmation);\r\n    });\r\n};\r\nconsole.log(cardForDelete.id)\r\nformConfirmation.addEventListener('submit', handleDeleteCardSubmit);\r\n// ------------------------------------------------------------------------\r\n\r\navatarForm.addEventListener(\"submit\", (evt) => {\r\n  evt.preventDefault();\r\n  const avatarInput = avatarForm.querySelector(\".popup__input_type_avatar\");\r\n\r\n  renderLoading(true, avatarSubmitButton)\r\n  updateAvatar(avatarInput.value).then((res) => {\r\n      profileImage.style['background-image'] = `url(${res.avatar})`;\r\n      closeModal(avatarPopup);\r\n    })\r\n    .catch((err) => {\r\n      console.error(`Ошибка обновления аватара: ${err}`);\r\n    })\r\n    .finally(() => {renderLoading(false, avatarSubmitButton)})\r\n});\r\n\r\n// ------------------------------------------------------------------------\r\n// Промисы\r\nPromise.all([ getUserProfile(), getCards() ])\r\n.then(( [ user, cards ]) => {\r\n   profileTitle.textContent = user.name\r\n   profileDescription.textContent = user.about\r\n   profileImage.style['background-image'] = `url(${user.avatar})`\r\n   userId = user._id;\r\n   cards.forEach((item) => {\r\n      const card = createCard( item, userId, cardCallbacks );\r\n      cardList.append(card);\r\n   })\r\n   \r\n})\r\n// ------------------------------------------------------------------------\r\n// Коллбэки\r\nconst cardCallbacks = {\r\n   cardRemove: handleDeleteCard,\r\n   openImage: handleOpenImage,\r\n   cardLike: handleLikeSubmit,\r\n};\r\n// ------------------------------------------------------------------------\r\n"],"names":["createCard","cardObject","userID","_ref","cardRemove","openImage","cardLike","cardElement","document","querySelector","content","cloneNode","buttonDelete","cardImage","likeButton","likeCountElement","textContent","name","src","link","alt","likes","some","user","_id","classList","add","length","addEventListener","owner","remove","handleEsc","evt","key","popup","closeModal","openModal","modal","setTimeout","removeEventListener","addPopupListener","target","currentTarget","hideInputError","formElement","inputElement","selectors","errorElement","concat","id","inputErrorClass","errorClass","clearValidation","inputList","Array","from","querySelectorAll","inputSelector","buttonElement","submitButtonSelector","forEach","toggleButtonState","validity","valid","hasInvalidInput","inactiveButtonClass","disabled","cohortId","PATH","headers","authorization","checkResponse","res","ok","json","then","error","httpStatusCode","status","Promise","reject","userId","cardList","editProfileButton","popupEdit","profileTitle","profileDescription","profileImage","editProfileSubmit","forms","nameInput","elements","jobInput","description","addImageButton","popupNewCard","popupImage","zoomImage","captionImage","editCardSubmit","popupConfirmationDelete","formConfirmation","confirmation","buttonDeleteConfirmation","formElementCard","cardNameInput","cardLinkInput","avatarPopup","avatarForm","avatarSubmitButton","validationConfig","formSelector","cardForDelete","renderLoading","isLoading","value","reset","patternMismatch","setCustomValidity","dataset","errorMessage","showInputError","validationMessage","checkInputValidity","setEventListeners","nameUser","aboutUser","preventDefault","fetch","method","body","JSON","stringify","about","finally","nameCard","linkCard","cardCallbacks","prepend","console","log","cardID","catch","err","updateAvatarLink","avatarInput","avatar","style","all","_ref2","_ref3","cards","item","card","append","isLiked","contains","endpoint","toggleLike","updatedCardData","toggle"],"sourceRoot":""}